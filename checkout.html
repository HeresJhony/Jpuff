<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</title>
    <link rel="stylesheet" href="css/style.css?v=V_LATEST">
    <link rel="stylesheet" href="css/css_sidebar.css?v=V_LATEST">
    <script src="js/telegram-web-app.js"></script>

</head>

<body class="has-footer">
    <header>
        <h1>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h1>
        <div style="width: 40px;"></div> <!-- Spacer to center title -->
    </header>

    <main class="container">
        <form id="checkout-form" onsubmit="event.preventDefault(); submitOrderForm();">
            <h2>–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</h2>

            <label for="name">–ò–º—è –∏ –§–∞–º–∏–ª–∏—è (*)</label>
            <input type="text" id="name" required placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤">

            <label for="phone">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (*)</label>
            <input type="tel" id="phone" placeholder="+7 999 123-45-67" value="+7 " required>

            <!-- Delivery Method Selector -->
            <label>–°–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è (*)</label>
            <div class="radio-group">
                <label class="radio-container">
                    <input type="radio" name="delivery_type" value="pickup" checked>
                    <span class="checkmark"></span>
                    üè† –°–∞–º–æ–≤—ã–≤–æ–∑
                </label>
                <label class="radio-container">
                    <input type="radio" name="delivery_type" value="delivery">
                    <span class="checkmark"></span>
                    üöó –î–æ—Å—Ç–∞–≤–∫–∞
                </label>
            </div>

            <!-- Address Field (Hidden by default for Pickup) -->
            <div id="address-block" style="display: none; margin-top: 15px;">
                <label for="address">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ (*)</label>
                <input type="text" id="address" placeholder="–£–ª–∏—Ü–∞, –î–æ–º, –ü–æ–¥—ä–µ–∑–¥">
            </div>

            <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
            <textarea id="comment" placeholder="–î–æ–º–æ—Ñ–æ–Ω, —ç—Ç–∞–∂ –∏ —Ç.–¥."></textarea>

            <!-- Discount Selection Section -->
            <div class="discount-selection-section" style="margin-bottom: 25px;">
                <h3 style="margin-top: 20px; margin-bottom: 10px;">–ñ–µ–ª–∞–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫–∏–¥–∫—É?</h3>

                <div class="radio-group">
                    <label class="radio-container">
                        <input type="radio" name="use_discount" value="no" checked onchange="toggleDiscountInput()">
                        <span class="checkmark"></span>
                        –ù–µ—Ç
                    </label>
                    <label class="radio-container">
                        <input type="radio" name="use_discount" value="yes" onchange="toggleDiscountInput()">
                        <span class="checkmark"></span>
                        –î–∞
                    </label>
                </div>

                <!-- Discount Dropdown (Hidden by default) -->
                <div id="discount-input-block" style="display: none; margin-top: 15px;">
                    <label for="discount-select"
                        style="color: #aaa; font-size: 0.9em; margin-bottom: 5px; display:block;">–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—É—é
                        —Å–∫–∏–¥–∫—É:</label>
                    <select id="discount-select" onchange="updateOverallTotal()" style="
                        width: 100%;
                        padding: 12px;
                        background-color: #050510;
                        border: 1px solid #d000ff;
                        border-radius: 0; 
                        color: white;
                        font-size: 1em;
                        outline: none;
                        cursor: pointer;
                        -webkit-appearance: none;
                        -moz-appearance: none;
                        appearance: none;
                        background-image: linear-gradient(45deg, transparent 50%, #00f3ff 50%), linear-gradient(135deg, #00f3ff 50%, transparent 50%);
                        background-position: calc(100% - 20px) calc(1em + 2px), calc(100% - 15px) calc(1em + 2px);
                        background-size: 5px 5px, 5px 5px;
                        background-repeat: no-repeat;
                    ">
                        <option value="none">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–∫–∏–¥–æ–∫</option>
                    </select>
                    <div id="discount-applied-msg"
                        style="color: var(--neon-blue); font-size: 0.9em; margin-top: 5px; display: none;">
                        –°–∫–∏–¥–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞!
                    </div>
                </div>
            </div>

            <h2>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</h2>
            <select id="payment">
                <option value="cash">–ù–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</option>
                <option value="card">–ü–µ—Ä–µ–≤–æ–¥–æ–º –Ω–∞ –∫–∞—Ä—Ç—É</option>
            </select>

            <!-- Bonus Payment Section -->
            <div class="bonus-payment-section">
                <h3 style="margin-top: 20px; margin-bottom: 10px;">–ñ–µ–ª–∞–µ—Ç–µ –æ–ø–ª–∞—Ç–∏—Ç—å –±–æ–Ω—É—Å–∞–º–∏?</h3>

                <div class="radio-group">
                    <label class="radio-container">
                        <input type="radio" name="use_bonuses" value="no" checked onchange="toggleBonusInput()">
                        <span class="checkmark"></span>
                        –ù–µ—Ç
                    </label>
                    <label class="radio-container">
                        <input type="radio" name="use_bonuses" value="yes" onchange="toggleBonusInput()">
                        <span class="checkmark"></span>
                        –î–∞
                    </label>
                </div>

                <!-- Bonus Input Block (Hidden by default) -->
                <div id="bonus-input-block" style="display: none; margin-top: 15px;">
                    <div
                        style="background: rgba(255, 215, 0, 0.1); border: 2px solid rgba(255, 215, 0, 0.5); border-radius: 12px; padding: 15px; margin-bottom: 15px;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <span style="color: #ddd;">–î–æ—Å—Ç—É–ø–Ω–æ –±–æ–Ω—É—Å–æ–≤:</span>
                            <span id="available-bonuses"
                                style="font-size: 1.3em; font-weight: 700; color: #ffd700;">0</span>
                        </div>
                        <div style="font-size: 0.85em; color: #aaa;">1 –±–æ–Ω—É—Å = 1 —Ä—É–±–ª—å</div>
                    </div>

                    <label for="bonus-amount">–°–∫–æ–ª—å–∫–æ –∂–µ–ª–∞–µ—Ç–µ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å:</label>
                    <input type="number" id="bonus-amount" min="0" max="0" value="0" placeholder="0"
                        oninput="updateBonusPayment()" style="font-size: 1.1em; font-weight: 600; color: #ffd700;">

                    <div id="bonus-discount-info"
                        style="margin-top: 10px; padding: 10px; background: rgba(0, 255, 136, 0.1); border-radius: 8px; color: #00ff88; font-size: 0.9em; display: none;">
                        –°–∫–∏–¥–∫–∞ –±–æ–Ω—É—Å–∞–º–∏: <span id="bonus-discount-amount">0</span> ‚ÇΩ
                    </div>
                </div>
            </div>

            <div class="age-confirm" style="margin-top: 15px;">
                <input type="checkbox" id="age-confirm" required
                    oninvalid="this.setCustomValidity('–í–∞–º –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 18+ –ª–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –¥–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤')"
                    oninput="this.setCustomValidity('')">
                <label for="age-confirm">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é, —á—Ç–æ –º–Ω–µ –∏—Å–ø–æ–ª–Ω–∏–ª–æ—Å—å 18+ –ª–µ—Ç (*)</label>
            </div>




            <div id="checkout-total-display" style="
                margin: 20px 0;
                padding: 15px;
                background: rgba(0, 0, 0, 0.3);
                border: 1px solid var(--neon-blue);
                border-radius: 8px;
                text-align: center;
                font-size: 1.2em;
                color: white;
            ">
                –ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ: <span id="checkout-sum">...</span>
            </div>

            <button type="submit" id="place-order-btn" class="place-order-btn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ó–∞–∫–∞–∑</button>
        </form>

        <div id="success-modal" class="success-modal">
            <div class="success-modal-content">
                <h3>‚úÖ –ó–∞–∫–∞–∑ –û—Ñ–æ—Ä–º–ª–µ–Ω!</h3>
                <p>–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É.<br>–°–∫–æ—Ä–æ —Å –≤–∞–º–∏ —Å–≤—è–∂–µ—Ç—Å—è –Ω–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä.</p>
                <p style="font-size: 0.9em; color: var(--text-dim); margin-top: 10px;">–î–ª—è –≤—ã–¥–∞—á–∏ —Ç–æ–≤–∞—Ä–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è
                    –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ –ø–∞—Å–ø–æ—Ä—Ç–æ–º. <br><span
                        style="color: var(--neon-pink); font-weight: bold; font-size: 1.2em;">–ü—Ä–æ–¥–∞–∂–∞ —Å—Ç—Ä–æ–≥–æ —Å 18+
                        –ª–µ—Ç!</span></p>
                <button onclick="closeSuccessModal()"
                    style="margin-top: 20px; padding: 10px 30px; background: var(--neon-blue); color: black; border: none; font-family: var(--font-heading); font-weight: bold; cursor: pointer; clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);">OK</button>
            </div>
        </div>

        <!-- Stock Error Modal -->
        <div id="stock-error-modal" class="success-modal" style="display: none;">
            <div class="success-modal-content" style="border-color: var(--neon-pink);">
                <h3 style="color: var(--neon-pink);">‚õî –û–π! –¢–æ–≤–∞—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è</h3>
                <p style="margin-bottom: 15px;">–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –∫—Ç–æ-—Ç–æ —É—Å–ø–µ–ª –∫—É–ø–∏—Ç—å —Ç–æ–≤–∞—Ä —Ä–∞–Ω—å—à–µ –≤–∞—Å:</p>
                <div id="stock-error-list"
                    style="text-align: left; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 0.9em; line-height: 1.4;">
                    <!-- Items will be injected here -->
                </div>
                <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–∑–∏–Ω—É –∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ –∑–∞–∫–∞–∑.</p>
                <button onclick="document.getElementById('stock-error-modal').style.display='none'"
                    style="margin-top: 15px; padding: 10px 30px; background: var(--neon-pink); color: white; border: none; font-family: var(--font-heading); font-weight: bold; cursor: pointer; clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);">–ü–û–ù–Ø–¢–ù–û</button>
            </div>
        </div>
    </main>

    <script src="js/sidebar.js?v=V_LATEST"></script>
    <script type="module" src="js/cart.js?v=FIX_CACHE_WEB_REF_1"></script>
    <!-- FAB Button -->
    <button onclick="openSidebar()" class="hamburger-btn">‚ò∞</button>
</body>

</html>